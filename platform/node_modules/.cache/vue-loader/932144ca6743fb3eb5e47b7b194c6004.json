{"remainingRequest":"D:\\Learning_platform-master\\platform\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Learning_platform-master\\platform\\src\\views\\recovery.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"D:\\Learning_platform-master\\platform\\src\\views\\recovery.vue","mtime":1750727682152},{"path":"D:\\Learning_platform-master\\platform\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Learning_platform-master\\platform\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\Learning_platform-master\\platform\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\Learning_platform-master\\platform\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Learning_platform-master\\platform\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Learning_platform-master\\platform\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLnRpbCB7CiAgY29sb3I6ICMyZDczY2M7CiAgZm9udC13ZWlnaHQ6IGJvbGRlcjsKICBmb250LXNpemU6IDYwcHg7Cn0KLmJhY2sybG9naW4gewogIGN1cnNvcjogcG9pbnRlcjsKICBjb2xvcjogIzI5OGFkYjsKICBmbG9hdDogcmlnaHQ7CiAgcGFkZGluZy1ib3R0b206IDMwcHg7CiAgZm9udC1zaXplOiAxOHB4Owp9Ci5ib3gtY2FyZCB7CiAgbWFyZ2luOiAwIGF1dG87CiAgd2lkdGg6IDQ4MHB4Owp9Ci5teUxvZ2luVUkgewogIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICB0b3A6IDUwJTsKICBsZWZ0OiA1MCU7CiAgbWFyZ2luOiAtMjgwcHggMCAwIC0yNDBweDsKICB3aWR0aDogNDgwcHg7Cn0K"},{"version":3,"sources":["recovery.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+SA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"recovery.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div>\n    <div\n        style=\"background-color: #f7f7f7; display: flex; justify-content: center; align-items: center; height: 90px;\"\n    >\n      <span class=\"til\">大连理工大学在线教育平台</span>\n    </div>\n\n    <div :style=\"backgroundStyle\"></div>\n\n    <div class=\"myLoginUI\">\n      <el-card class=\"box-card\">\n        <div v-show=\"cur==0\">\n          <h1 class=\"h1\">找回密码</h1>\n          <el-form\n              ref=\"recoveryForm\"\n              :model=\"recoveryForm\"\n              :rules=\"recoveryRules\"\n              class=\"login-form\"\n              autocomplete=\"on\"\n              label-position=\"left\"\n          >\n            <el-form-item prop=\"email\">\n              <el-input\n                  ref=\"email\"\n                  v-model=\"recoveryForm.email\"\n                  placeholder=\"请输入邮箱\"\n                  name=\"email\"\n                  type=\"text\"\n                  tabindex=\"1\"\n                  autocomplete=\"on\"\n                  prefix-icon=\"el-icon-message\"\n              />\n            </el-form-item>\n\n            <el-form-item prop=\"emailCode\">\n              <el-input\n                  ref=\"password\"\n                  v-model=\"recoveryForm.emailCode\"\n                  type=\"text\"\n                  placeholder=\"请输入邮箱验证码\"\n                  name=\"emailCode\"\n                  tabindex=\"2\"\n                  autocomplete=\"on\"\n                  prefix-icon=\"el-icon-chat-dot-square\"\n                  style=\"width: 60%; float: left;\"\n              />\n              <el-button\n                  type=\"primary\"\n                  plain\n                  style=\"float: right\"\n                  :disabled=\"disabled\"\n                  @click=\"getEmailCode()\"\n              >{{btntxt}}</el-button>\n            </el-form-item>\n\n            <el-button\n                :loading=\"loading\"\n                type=\"primary\"\n                style=\"width:100%;margin-bottom:20px;\"\n                @click.native.prevent=\"submitEmailCode\"\n            >确定</el-button>\n          </el-form>\n        </div>\n\n        <div v-show=\"cur==1\" class=\"Cbody_item\">\n          <h1 class=\"h1\">重置密码</h1>\n          <el-form\n              ref=\"resetForm\"\n              :model=\"resetForm\"\n              :rules=\"resetRules\"\n              class=\"login-form\"\n              autocomplete=\"on\"\n              label-position=\"left\"\n          >\n            <el-form-item prop=\"newPassword\">\n              <el-input\n                  :key=\"passwordType\"\n                  ref=\"newPassword\"\n                  v-model=\"resetForm.newPassword\"\n                  placeholder=\"请输入新密码\"\n                  name=\"newPassword\"\n                  :type=\"passwordType\"\n                  tabindex=\"1\"\n                  autocomplete=\"on\"\n                  prefix-icon=\"el-icon-lock\"\n              />\n            </el-form-item>\n\n            <el-form-item prop=\"newPasswordAgain\">\n              <el-input\n                  :key=\"passwordType\"\n                  placeholder=\"请确认新密码\"\n                  ref=\"newPasswordAgain\"\n                  v-model=\"resetForm.newPasswordAgain\"\n                  name=\"newPasswordAgain\"\n                  :type=\"passwordType\"\n                  tabindex=\"2\"\n                  autocomplete=\"on\"\n                  prefix-icon=\"el-icon-lock\"\n              />\n            </el-form-item>\n\n            <el-button\n                :loading=\"loading\"\n                type=\"primary\"\n                style=\"width:100%;margin-bottom:20px;\"\n                @click.native.prevent=\"handleReset\"\n            >确认重置</el-button>\n          </el-form>\n        </div>\n        <span class=\"back2login\" @click=\"back2login\">返回登录</span>\n\n        <Vcode :show=\"isShow\" @success=\"success\" @close=\"close\" />\n      </el-card>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Vcode from \"vue-puzzle-vcode\";\nimport {\n  sendEmailCode,\n  checkEmailCode,\n  resetPassword\n} from \"@/api/modules/user\";\n\nexport default {\n  name: \"login\",\n  data() {\n    var checkPassword = (rule, value, callback) => {\n      if (!value) {\n        return callback(new Error(\"密码不能为空\"));\n      }\n\n      if (value.length >= 5) {\n        callback();\n      } else {\n        callback(new Error(\"长度不能小于6位\"));\n      }\n    };\n\n    var checkPasswordAgain = (rule, value, callback) => {\n      let password = this.$refs.newPassword.value;\n      if (!value) {\n        return callback(new Error(\"确认密码不能为空\"));\n      } else {\n        if (value != password) {\n          return callback(new Error(\"两次输入密码不一致\"));\n        }\n        callback();\n      }\n    };\n\n    var userEmail = (rule, value, callback) => {\n      const mailReg = /^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/;\n      if (!value) {\n        return callback(new Error(\"邮箱不能为空\"));\n      }\n      setTimeout(() => {\n        if (mailReg.test(value)) {\n          callback();\n        } else {\n          callback(new Error(\"请输入正确的邮箱格式\"));\n        }\n      }, 100);\n    };\n\n    return {\n      recoveryForm: {\n        email: \"\",\n        emailCode: \"\"\n      },\n      resetForm: {\n        newPassword: \"\",\n        newPasswordAgain: \"\"\n      },\n      recoveryRules: {\n        email: { validator: userEmail, trigger: \"blur\" },\n        emailCode: {\n          required: true,\n          message: \"验证码不能为空\",\n          trigger: \"blur\"\n        }\n      },\n      resetRules: {\n        newPassword: { validator: checkPassword, trigger: \"blur\" },\n        newPasswordAgain: { validator: checkPasswordAgain, trigger: \"blur\" }\n      },\n      isShow: false,\n      loading: false,\n      passwordType: \"password\",\n      redirect: undefined,\n      time: 0,\n      btntxt: \"获取验证码\",\n      disabled: false,\n      type: \"0\",\n      cur: 0,\n      user_id: \"\",\n\n      backgroundStyle: {\n        backgroundImage: `url(${require('@/assets/background.png')})`,\n        width: '100%',\n        position: 'fixed',\n        height: '100%',\n        top: '90px',\n        left: '0px',\n        backgroundSize: 'cover',\n        backgroundRepeat: 'no-repeat'\n      }\n    };\n  },\n\n  components: {\n    Vcode\n  },\n\n  methods: {\n    submitEmailCode() {\n      checkEmailCode({\n        email: this.recoveryForm.email,\n        email_code: this.recoveryForm.emailCode\n      })\n          .then(resp => {\n            if (resp.data.success) {\n              this.toast(resp.data.message, 1);\n              this.user_id = resp.data.data.id;\n              this.cur = 1;\n            }\n          })\n          .catch(data => {\n            this.toast(data, 2);\n          });\n    },\n\n    handleReset() {\n      this.$refs.resetForm.validate(valid => {\n        if (valid) {\n          this.loading = true;\n          this.isShow = true;\n        }\n      });\n    },\n\n    success(msg) {\n      this.isShow = false;\n      this.loading = false;\n      resetPassword({\n        user_id: this.user_id,\n        newPassword: this.resetForm.newPassword\n      })\n          .then(resp => {\n            this.toast(resp.data.message, 1);\n            this.navigator(\"/login\");\n          })\n          .catch(data => {\n            this.toast(data, 2);\n          });\n    },\n\n    close() {\n      this.isShow = false;\n      this.loading = false;\n    },\n\n    getEmailCode() {\n      this.$refs.recoveryForm.validateField(\"email\", err => {\n        if (!err) {\n          this.time = 60;\n          this.timer();\n          this.type = 1;\n          sendEmailCode({ email: this.recoveryForm.email, type: this.type })\n              .then(resp => {\n                this.toast(resp.data.message, 1);\n              })\n              .catch(data => {\n                this.toast(data, 2);\n              });\n        }\n      });\n    },\n\n    timer() {\n      if (this.time > 0) {\n        this.time--;\n        this.btntxt = this.time + \"s后重新获取\";\n        this.disabled = true;\n        setTimeout(this.timer, 1000);\n      } else {\n        this.time = 0;\n        this.btntxt = \"获取验证码\";\n        this.disabled = false;\n      }\n    },\n\n    back2login() {\n      this.navigator(\"/login\");\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\">\n.til {\n  color: #2d73cc;\n  font-weight: bolder;\n  font-size: 60px;\n}\n.back2login {\n  cursor: pointer;\n  color: #298adb;\n  float: right;\n  padding-bottom: 30px;\n  font-size: 18px;\n}\n.box-card {\n  margin: 0 auto;\n  width: 480px;\n}\n.myLoginUI {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  margin: -280px 0 0 -240px;\n  width: 480px;\n}\n</style>\n"]}]}